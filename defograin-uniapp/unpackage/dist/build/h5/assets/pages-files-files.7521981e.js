import{E as e,G as t,H as l,n as s,a,o,e as i,f as n,w as c,F as r,k as d,t as h,d as g,g as u,i as p,r as f,x as m,y as k,D as _,z as y,I as F,v as w,j as v,C as A,B as b}from"./index-9cc2789b.js";import{g as C,a as P,b as x,c as E,_ as j}from"./newLogo.cf92213c.js";import{_ as S}from"./_plugin-vue_export-helper.1b428a4d.js";const T=S({data:()=>({sidebarItems:[{title:"单例运行",url:"../index/index",active:!1},{title:"文件库",url:"../files/files",active:!0},{title:"算法库",url:"../alglist/alglist",active:!1},{title:"运行结果",url:"../result/result",active:!1}],filesAndFolders:[],alglist:[],currentPath:"",showActionSheet:!0,entries:[],currentPage:1,pageSize:8,entryHeight:200,itemHeight:"100px",activeOperation:"derain",selectedAlgorithms:[],showDropdown:!1,selectedFolderName:"",finish:!1}),onMounted(){this.adjustEntryItemHeight(),e((e=>{this.adjustEntryItemHeight()}))},onLoad(){this.fetchFilesAndFolders(""),C().then((e=>{console.log(e),this.alglist=e.data.algs;for(var t=0;t<this.alglist.length;t++)this.alglist[t].checked=!1;console.log(this.alglist)}))},computed:{totalPages(){return Math.ceil(this.filesAndFolders.length/this.pageSize)},paginatedFilesAndFolders(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filesAndFolders.slice(e,t)},selectAllText(){return this.alglist.filter((e=>e.operation===this.activeOperation)).every((e=>e.checked))?"取消全选":"全选"},filteredAlgList(){return this.alglist.filter((e=>e.operation===this.activeOperation))}},mounted(){this.fetchFilesAndFolders(this.currentPath)},methods:{adjustEntryItemHeight(){const e=t().windowHeight/15+"px";this.itemHeight=e},onBeforeUnmount(){l()},handleScroll(e){const{scrollTop:t,scrollHeight:l,clientHeight:s}=e.target;t+s===l&&this.nextPage()},scrollToTop(){window.scrollTo({top:0,behavior:"smooth"})},nextPage(){this.currentPage<this.totalPages&&(this.currentPage++,this.scrollToTop())},previousPage(){this.currentPage>1&&(this.currentPage--,this.scrollToTop())},selectalg(e){const t=e.detail.value;this.alglist.forEach((e=>{e.checked=t.includes(e.title)})),this.selectedAlgorithms=[];for(let l=0;l<this.alglist.length;l++)this.alglist[l].checked&&this.selectedAlgorithms.push(this.alglist[l].title);console.log(this.selectedAlgorithms,this.alglist)},toggleSelectAll(){var e=this.alglist.filter((e=>e.operation===this.activeOperation));const t=e.every((e=>e.checked));e.forEach((e=>{e.checked=!t})),this.selectedAlgorithms.length===e.length?this.selectedAlgorithms=[]:this.selectedAlgorithms=e.map((e=>e.title)),console.log(this.selectedAlgorithms)},handleSidebarItemClick(e){console.log("点击了菜单项:",e),s({url:e.url})},processFolderContent(e,t){this.showDropdown=!0,this.selectedFolderName=e,console.log(`处理文件夹：${e}`),this.activeOperation=t},closeDropdown(){this.showDropdown=!1,this.selectedAlgorithms=[];var e=this.alglist.filter((e=>e.operation===this.activeOperation));e.every((e=>e.checked)),e.forEach((e=>{e.checked=!1}))},getEntryUrl(e){P(e.name).then((e=>(console.log(e),e.data)))},fetchFilesAndFolders(e){console.log({}.VUE_APP_SERVER_URL),x(e,"").then((e=>{this.filesAndFolders=e.data,this.entries=e.data,console.log(this.entries)}))},enterFolder(e){let t=this.currentPath?`${this.currentPath}/${e}`:e;this.fetchFilesAndFolders(t),this.currentPath=t,this.currentPage=1},goBack(){let e=this.currentPath.split("/");e.pop();let t=e.join("/");this.fetchFilesAndFolders(t),this.currentPath=t||""},isImage:e=>e.toLowerCase().match(/\.(jpg|jpeg|png|gif|bmp)$/),downloadFile(e,t){fetch(e).then((e=>{if(e.ok)return e.blob();throw new Error("Network response was not ok.")})).then((e=>{const l=window.URL.createObjectURL(e),s=document.createElement("a");s.href=l,s.download=t,document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(l)})).catch((e=>{console.error("There was a problem with the fetch operation:",e)}))},uploadFiles(){console.log(this.selectedAlgorithms,this.activeOperation);let e=this.currentPath?`${this.currentPath}/${this.selectedFolderName}`:this.selectedFolderName;E(e,this.activeOperation,this.selectedAlgorithms).then((e=>{console.log(e),"401"==e.data.code?a({title:e.data.msg,icon:"none",duration:2e3,mask:!0}):this.downloadFile(e.data.url,e.data.name)}))}}},[["render",function(e,t,l,s,a,C){const P=d,x=k,E=v,S=A,T=b,H=_,L=y;return o(),i(r,null,[n(P,{class:"header"},{default:c((()=>[h("img",{class:"logo",src:j,alt:"",srcset:""})])),_:1}),n(P,{class:"sidebar-container"},{default:c((()=>[n(P,{class:"main-content"},{default:c((()=>[""!==a.currentPath?(o(),g(P,{key:0,class:"back-button-container"},{default:c((()=>[n(x,{onClick:C.goBack},{default:c((()=>[u("返回上一级")])),_:1},8,["onClick"])])),_:1})):p("",!0),n(P,{class:"entries-container",onScroll:t[0]||(t[0]=e=>C.handleScroll())},{default:c((()=>[(o(!0),i(r,null,f(C.paginatedFilesAndFolders,((e,t)=>(o(),g(P,{key:t,class:"entry-item"},{default:c((()=>["file"===e.type?(o(),g(P,{key:0,class:"entry-content"},{default:c((()=>["file"===e.type?(o(),g(E,{key:0,src:e.url,class:"entry-image",mode:"aspectFit"},null,8,["src"])):p("",!0),n(S,{onClick:t=>C.downloadFile(e.url,e.name),class:"entry-name"},{default:c((()=>[u(m(e.name),1)])),_:2},1032,["onClick"])])),_:2},1024)):(o(),g(P,{key:1,onClick:t=>"directory"===e.type?C.enterFolder(e.name):null,class:"entry-content"},{default:c((()=>[n(E,{src:e.url,class:"entry-image",mode:"aspectFit"},null,8,["src"]),"directory"===e.type?(o(),g(S,{key:0,class:"entry-name"},{default:c((()=>[u(m(e.name),1)])),_:2},1024)):p("",!0),"gh"==e.input_type?(o(),g(x,{key:1,class:"process-folder-btn",onClick:F((t=>C.processFolderContent(e.name,"derain")),["stop"])},{default:c((()=>[u("去雨")])),_:2},1032,["onClick"])):p("",!0),"gh"==e.input_type?(o(),g(x,{key:2,class:"process-folder-btn2",onClick:F((t=>C.processFolderContent(e.name,"defog")),["stop"])},{default:c((()=>[u("去雾")])),_:2},1032,["onClick"])):p("",!0)])),_:2},1032,["onClick"]))])),_:2},1024)))),128))])),_:1}),n(P,{class:"pagination-controls"},{default:c((()=>[n(x,{onClick:C.previousPage,disabled:1===a.currentPage},{default:c((()=>[u("上一页")])),_:1},8,["onClick","disabled"]),n(x,{onClick:C.nextPage,disabled:a.currentPage>=C.totalPages},{default:c((()=>[u("下一页")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1}),a.showDropdown?(o(),g(P,{key:0,class:"dropdown-popup"},{default:c((()=>[n(P,{class:"dropdown-content"},{default:c((()=>[n(x,{onClick:C.closeDropdown,class:"cancel-button"},{default:c((()=>[u("取消")])),_:1},8,["onClick"]),n(L,{onChange:C.selectalg},{default:c((()=>[(o(!0),i(r,null,f(C.filteredAlgList,(e=>(o(),g(H,{class:"checkbox-label",key:e.title},{default:c((()=>[n(T,{value:e.title,checked:e.checked,class:w({"is-checked":e.checked})},null,8,["value","checked","class"]),h("div",{class:"checkbox-custom"}),n(S,null,{default:c((()=>[u(m(e.title),1)])),_:2},1024)])),_:2},1024)))),128)),n(H,{class:"upload-button-label"},{default:c((()=>[n(x,{onClick:C.uploadFiles,class:"upload-button"},{default:c((()=>[u("上传文件")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["onChange"]),n(x,{onClick:C.toggleSelectAll,class:"select-all-button"},{default:c((()=>[u(m(C.selectAllText),1)])),_:1},8,["onClick"])])),_:1})])),_:1})):p("",!0)])),_:1})],64)}],["__scopeId","data-v-762bcfc5"]]);export{T as default};
