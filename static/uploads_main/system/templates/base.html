{% extends "bootstrap/base.html" %}
{% block title %}去雨去雾系统原型{% endblock %}
{% block content %}
<h2 style="text-align: center;">去雨去雾系统原型</h2>
<nav id="navbar" class="navbar navbar-light bg-light">
    <div class="container-fluid">
        <div class="flex-navbar btn-group">
            <a href="#" class="flex-btn active" data-target="imageInputForm">图片输入</a>
            <a href="#" class="flex-btn" data-target="imageNameLibrary">图片名称库</a>
            <a href="#" class="flex-btn" data-target="AlgNameLibrary">算法名称库</a>
        </div>
    </div>
</nav>

<div class="container"> 

    <!-- 新增图片输入表单 -->
     <div class="contents active" id="imageInputForm" >
    <form method="post" enctype="multipart/form-data" class="form-horizontal" style="margin-top: 10px;margin:5px auto;" id="upload_img">
        <div class="form-group">
            <div class="col-lg-12">
                <!-- 原始图片输入保持不变 -->
                <input id="lefile" type="file" style="display:none;" name="selectfile">
                <div class="input-group">
                    <input id="photoCover" class="form-control input-lg" type="text"
                           style="height:34px;width:100%;border:2px #337ab7 solid"
                           placeholder="请选择需要去雾操作的影像">
                    <span class="input-group-btn">
                        <button class="btn btn-primary" style="margin:0 5px ;" type="button" onclick="$('#lefile').click();">浏览</button>
                        <button id="first-upload" type="submit" class="btn btn-primary">上传</button>
                    </span>
                </div>
            </div>
        </div>
        <!-- 新增图片输入 -->
        <div id="additionalImageInput" class="form-group">
            <div class="col-lg-12">
                <input id="lefile2" type="file" style="display:none;" name="selectfile2">
                <div class="input-group">
                    <input id="photoCover2" class="form-control input-lg" type="text"
                           style="height:34px;width:100%;border:2px #337ab7 solid"
                           placeholder="请选择对比的清晰影像">
                    <span class="input-group-btn">
                        <button class="btn btn-primary" style="margin:0 5px ;" type="button" onclick="$('#lefile2').click();">浏览</button>
                        <button type="submit" class="btn btn-primary">上传</button>
                    </span>
                </div>
            </div>
        </div>
        <div class="form-group">
            <div class="col-lg-12">
                <button id="toggleAdditionalImageInput" type="button" class="btn btn-secondary">添加对比图像</button>
            </div>
        </div>
    </form>
    <!-- 现有代码 -->
    <!-- ... -->
    {% if image_list and uploads_num != '' %}
    <div class="container2">
    <div class="well">
    <h3>{{ image_list[0].name }}</h3>
    <img src="{{ url_for('static', filename='uploads_hazy/' + image_list[0].filename)}}" width="300px" height="300px"/>
    {% if image_list[0].scores %}
    {% for score_key, score_value in image_list[0].scores.items() %}
    <div>{{ score_key }}: {{ score_value }}</div>
    {% endfor %}
    {% endif %}
    </div>
    <div class="well">
    <h3>{{ image_list[1].name }}</h3>
    <img src="{{ url_for('static', filename='uploads_GT/' + image_list[1].filename) }}" width="300px" height="300px"/>
    {% if image_list[1].scores %}
    {% for score_key, score_value in image_list[1].scores.items() %}
    <div>{{ score_key }}: {{ score_value }}</div>
    {% endfor %}
    {% endif %}
    </div>
    {% for image in image_list[2:] %}
    <div class="well">
    <h3>{{ image.name }}</h3>
    <img src="{{ url_for('static', filename='results/' + image.filename) }}" width="300px" height="300px"/>
    {% if image.scores %}
    {% for score_key, score_value in image.scores.items() %}
    <div>{{ score_key }}: {{ score_value }}</div>
    {% endfor %}
    {% endif %}
    </div>
    {% endfor %}
    <div class="well">
        <h3>PSNR</h3>
        <img src="{{ url_for('static', filename='results/psnr.png') }}" width="300px" height="300px"/>
    </div>
    <div class="well">
        <H3>SSIM</H3>
        <img src="{{ url_for('static', filename='results/ssim.png') }}" width="300px" height="300px"/>
    </div>
    {% endif %}
    {% if image_list and uploads_num == '' %}
    <div class="container2">
    <div class="well">
    <h3>{{ image_list[0].name }}</h3>
    <img src="{{ url_for('static', filename='uploads_hazy/' + image_list[0].filename)}}" width="300px" height="300px"/>
    {% if image_list[0].scores %}
    {% for score_key, score_value in image_list[0].scores.items() %}
    <div>{{ score_key }}: {{ score_value }}</div>
    {% endfor %}
    {% endif %}
    </div>
    {% for image in image_list[1:] %}
    <div class="well">
    <h3>{{ image.name }}</h3>
    <img src="{{ url_for('static', filename='results/' + image.filename) }}" width="300px" height="300px"/>
    {% if image.scores %}
    {% for score_key, score_value in image.scores.items() %}
    <div>{{ score_key }}: {{ score_value }}</div>
    {% endfor %}
    {% endif %}
    </div>
    {% endfor %}
    {% endif %}
    {% if image_list %}
    <div class="well">
        <H3>entropy</H3>
        <img src="{{ url_for('static', filename='results/entropy.png') }}" width="300px" height="300px"/>
    </div>
    <div class="well">
        <H3>mg</H3>
        <img src="{{ url_for('static', filename='results/mg.png') }}" width="300px" height="300px"/>
    </div>
    <div class="well">
        <H3>complexities</H3>
        <img src="{{ url_for('static', filename='results/complexities.png') }}" width="300px" height="300px"/>
    </div>
    <div class="well">
        <h3>time</h3>
        <img src="{{ url_for('static', filename='results/times.png') }}" width="300px" height="300px"/>
    </div>
    {% endif %}
    </div>
</div>
</div>
<!-- 现有代码 -->
<!-- ... -->
</div>
<div id="imageNameLibrary" class="contents">
    <div class="row">
        <div class="col-lg-12">
            <h3>文件夹中图片名称</h3>
            <ul class="list-group">
                {% for image in image_list %}
                    <li class="list-group-item">{{ image.name }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
<div id="AlgNameLibrary" class="contents"></div>
    <div class="row">
        <div class="col-lg-12">
            <h3>文件夹中图片名称2</h3>
            <ul class="list-group">
                {% for image in image_list %}
                    <li class="list-group-item">{{ image.name }}</li>
                {% endfor %}
            </ul>
        </div>
    </div>
</div>
 {% endblock %}

{% block scripts %}
{{ super() }}
<script type="text/javascript">
document.addEventListener('DOMContentLoaded', function() {
    // 切换内容显示
    document.querySelectorAll('.btn-group .flex-btn').forEach(function(button) {
        button.addEventListener('click', function(event) {
            event.preventDefault();
            var target = this.getAttribute('data-target');
            // 切换按钮激活状态
            document.querySelectorAll('.btn-group .flex-btn').forEach(function(btn) {
                btn.classList.remove('active');
            });
            this.classList.add('active');
            // 切换内容显示
            document.querySelectorAll('.contents').forEach(function(content) {
                content.classList.remove('active');
            });
            document.getElementById(target).classList.add('active');
        });
    });
});

    // 原始图片输入框的事件监听
    document.getElementById('lefile').addEventListener('change', function () {
        var file = this.files[0]
        document.getElementById('photoCover').value = file.name;
    });
    // 切换按钮事件监听
    document.querySelectorAll('input[name="options"]').forEach((radio) => {
        radio.addEventListener('change', function() {
            if (this.id === 'option1') {
                document.getElementById('imageInputForm').style.display = 'block';
                document.getElementById('imageNameLibrary').style.display = 'none';
                document.getElementById('output').style.display = 'block';
            } else if (this.id === 'option2') {
                document.getElementById('imageInputForm').style.display = 'none';
                document.getElementById('imageNameLibrary').style.display = 'block';
                document.getElementById('output').style.display = 'none';
            }
        });
    });
    // 新增图片输入框的事件监听
    document.getElementById('lefile2').addEventListener('change', function () {
        var file = this.files[0]
        document.getElementById('photoCover2').value = file.name;
    });
    $(document).ready(function(){
        // 监听按钮点击事件
        $('#toggleAdditionalImageInput').click(function(){
            // 切换第二个输入框的显示状态
            $('#additionalImageInput').slideToggle(function(){
                // 判断第二个输入框是否显示
                if ($('#additionalImageInput').is(':visible')) {
                    // 如果显示，修改按钮文本为"收起对比图像"
                    $('#toggleAdditionalImageInput').text('收起对比图像');
                    $('#first-upload').hide();
                } else {
                    // 如果隐藏，修改按钮文本为"添加对比图像"
                    $('#toggleAdditionalImageInput').text('添加对比图像');
                    $('#first-upload').show();
                    $('#additionalImageInput input[type="file"]').val('');
                }
            });
        });
        $('#upload_img').submit(function(e){
        // 检查第二个输入框是否可见
        if (!$('#additionalImageInput').is(':visible')) {
            // 如果不可见，移除第二个输入框
            $('#additionalImageInput input[type="file"]').val('');
        }
        // 继续表单提交
        return true;
    });
    });
</script>
<style>
    /* 添加到你的Bootstrap主题文件或新创建的CSS文件 */
    .container2 {
    display: flex;             /* 使用flex布局 */
    flex-wrap: wrap;           /* 允许子项换行 */
    justify-content: space-between; /* 在主轴上均匀分布子项 */
}
.a{
    color: black;
}
.container2::after {
    content: "";               /* 生成一个伪元素 */
    flex: auto;                /* 让伪元素自动填充剩余空间 */
    width: 33.3333%;           /* 设置伪元素的宽度 */
    min-width: 33.3333%;      /* 设置伪元素的最小宽度 */
}

.well {
    flex: 0 0 30%;             /* 设置每个.well的宽度为30%，不允许它们伸缩 */
    margin-bottom: 15px;       /* 设置底部外边距 */
    box-sizing: border-box;    /* 包括padding和border在内的宽度计算 */
    text-align: center;        /* 文本居中 */
}

/* 响应式布局调整，当屏幕宽度小于768px时，每行显示2个.well */
@media (max-width: 768px) {
    .well {
        flex: 0 0 48%;          /* 每行显示2个，因此宽度调整为48% */
    }
}

/* 响应式布局调整，当屏幕宽度小于480px时，每行显示1个.well */
@media (max-width: 480px) {
    .well {
        flex: 0 0 100%;         /* 每行显示1个，因此宽度调整为100% */
    }
}

.well {
    /* display: inline-block; */
    padding: 10px;
    background-color: #f5f5f5;
    border: 1px solid #e3e3e3;
    border-radius: 4px;
}
.well:first-child{
    margin-left: 0;
}
.well:last-child{
    margin-right: 0;
}

.well h3 {
    margin-top: 0;
    margin-bottom: 5px;
    text-align: center;
}

.well img {
    display: block;
    margin: 0 auto; /* 使图片在.well元素中居中 */
}
    /* 添加到你的Bootstrap主题文件或新创建的CSS文件 */
.well {
    padding: 10px;
    margin-bottom: 20px;
    background-color: #f5f5f5;
    border: 1px solid #e3e3e3;
    border-radius: 4px;
}

.well h3 {
    margin-top: 0;
    margin-bottom: 5px;
}

.well img {
    display: block;
    margin: 0 auto; /* 使图片在.well元素中居中 */
}
.navbar-light {
    background-color: #f8f9fa; /* 浅色背景 */
}

.btn-group .btn {
    border-radius: 0; /* 移除按钮的圆角 */
}

.contents {
    display: none; /* 默认隐藏内容 */
}

.contents.active {
    display: block; /* 显示激活的内容 */
}

/* 激活的按钮样式 */
.btn-group .btn.active {
    background-color: #007bff; /* 蓝色背景 */
    color: white;
}
/* Flex布局样式 */
.flex-navbar {
    display: flex;
    justify-content: space-between; /* 平均分布按钮 */
    width: 100%;
}

.flex-btn {
    flex: 1; /* 让每个按钮都可以伸缩以填满可用空间 */
    text-align: center; /* 文本居中 */
    padding: 10px; /* 添加一些内边距 */
    text-decoration: none; /* 移除下划线 */
    color: #333; /* 文本颜色 */
    background-color: #f8f9fa; /* 背景颜色 */
    border: 1px solid #ccc; /* 边框 */
    transition: background-color 0.3s; /* 平滑过渡效果 */
}

.flex-btn:hover, .flex-btn.active {
    background-color: #e9ecef; /* 鼠标悬停和激活状态下的背景颜色 */
    color: #007bff; /* 激活状态下的文本颜色 */
}

/* 可以添加其他样式以匹配你的设计需求 */

</style>
{% endblock %}
